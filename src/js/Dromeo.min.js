/**
*
*   Dromeo
*   Simple and Flexible Routing Framework for PHP, Python, Node/JS
*   @version: 0.6.3
*
*   https://github.com/foo123/Dromeo
*
**/
!function(e,t,n){"use strict";var r,o="object"==typeof module&&module.exports,u="function"==typeof define&&define.amd;o?module.exports=(module.$deps=module.$deps||{})[t]=module.$deps[t]||n.call(e,{NODE:module})||1:u&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(t)?define(t,["require","exports","module"],function(t,r,o){return n.call(e,{AMD:o})}):t in e||(e[t]=r=n.call(e,{})||1)&&u&&define(t,[],function(){return r})}(this,"Dromeo",function(e,t){"use strict";function n(e,t,n,r,o){var u=this;u.handlers=[],u.route=e,u.pattern=t,u.captures=n,u.method=r?r.toLowerCase():"*",u.namespace=o||null,u.dispose=function(){return u.handlers=null,u.route=null,u.pattern=null,u.captures=null,u.method=null,u.namespace=null,u}}function r(e){return parseInt(e,10)||0}function o(e){return y(e)?e:""+String(e)}function u(e){return P(e)?e:[e]}function i(e){return y(e)?D.unglue_params(e):e}var a="0.6.3",l={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Switch Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",419:"Authentication Timeout",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",440:"Login Timeout",444:"No Response",449:"Retry With",450:"Blocked by Windows Parental Controls",451:"Unavailable For Legal Reasons",494:"Request Header Too Large",495:"Cert Error",496:"No Cert",497:"HTTP to HTTPS",498:"Token expired/invalid",499:"Client Closed Request",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required",520:"Origin Error",521:"Web server is down",522:"Connection timed out",523:"Proxy Declined Request",524:"A timeout occurred",598:"Network read timeout error",599:"Network connect timeout error"},s=/^([a-zA-Z0-9-_]+\|[a-zA-Z0-9-_|]+)$/,c=/\((\d+)\)$/,d=/^\s+|\s+$/g,f=/([*+\[\]\(\)?^$\/\\:])/g,h="prototype",p=Object[h],g=(Array[h],Function[h],p.toString),m="hasOwnProperty",_="undefined"!=typeof global&&"[object global]"==g.call(global),P=function(e){return e instanceof Array||"[object Array]"===g.call(e)},R=function(e){return e instanceof Object||"[object Object]"===g.call(e)},y=function(e){return e instanceof String||"[object String]"===g.call(e)},T=function(e){return e instanceof Number||"[object Number]"===g.call(e)},b=function(e){return"function"==typeof e},v=String[h].trim?function(e){return e.trim()}:function(e){return e.replace(d,"")},A=function(e){return e.length>0},S=function(e){return e.replace(f,"\\$1")},E=function(e,t,n){var r,o;if(n=!0===n,t)for(r in t)t[m](r)&&(o=t[r],e[r]=T(o)?0+o:y(o)?o.slice():P(o)?n?E(new Array(o.length),o,n):o:R(o)&&n?E({},o,n):o);return e},N={php:/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/\/?)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},q=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],L=function(e,t,n){for(var r=N[n||"php"].exec(e),o={},u=14;u--;)r[u]&&(o[q[u]]=r[u]);return o[m]("port")&&(o.port=parseInt(o.port,10)),t?o[t.replace("PHP_URL_","").toLowerCase()]||null:(o.source&&delete o.source,o)},w=function(e){return decodeURIComponent(""+e)},j=function(e){return encodeURIComponent(""+e).split("!").join("%21").split("'").join("%27").split("(").join("%28").split(")").join("%29").split("*").join("%2A")},x=function(e){return j(e).split("%20").join("+")},C=function(e){var n,r,o,u,i,a,l,s,c,d,f,h,p,g=e.replace(/^&/,"").replace(/&$/,"").split("&"),_=g.length,P={};for(n=0;_>n;n++)if(s=g[n].split("="),c=w(v(s[0])),d=s.length<2?"":w(v(s[1])),r=c.indexOf("\x00"),r>-1&&(c=c.slice(0,r)),c&&"["!==c.charAt(0)){for(h=[],f=0,r=0;r<c.length;r++)if("["!==c.charAt(r)||f){if("]"===c.charAt(r)&&f&&(h.length||h.push(c.slice(0,f-1)),h.push(c.substr(f,r-f)),f=0,"["!==c.charAt(r+1)))break}else f=r+1;for(h.length||(h=[c]),r=0;r<h[0].length&&(l=h[0].charAt(r),(" "===l||"."===l||"["===l)&&(h[0]=h[0].substr(0,r)+"_"+h[0].substr(r+1)),"["!==l);r++);for(a=P,r=0,p=h.length;p>r;r++)if(c=h[r].replace(/^['"]|['"]$/g,""),i=a,""!==c&&" "!==c||0===r)t===a[c]&&(a[c]={}),a=a[c];else{o=-1;for(u in a)a[m](u)&&+u>o&&u.match(/^\d+$/g)&&(o=+u);c=o+1}i[c]=d}return P},I=function(e,t,n,r){var o,u,i=r?j:x;if(!0===t?t="1":!1===t&&(t="0"),null!=t){if("object"==typeof t){u=[];for(o in t)t[m](o)&&null!=t[o]&&u.push(I(e+"["+o+"]",t[o],n,r));return u.join(n)}return i(e)+"="+i(t)}return""},k=function(e,t,n){var r,o,u,i=[];arguments.length<2&&(t="&"),arguments.length<3&&(n=!1);for(o in e)e[m](o)&&(r=e[o],u=I(o,r,t,n),""!=u&&i.push(u));return i.join(t)},U=function(e,t,n){if(n){var r,o,u=[];for(e=e.split(t),o=0;o<e.length;o++)r=e[o],r=r.split(n),u.push(r[0]),r.length>1&&u.push(r[1]);return u}return e.split(t)},Y=function(e,t,n){var r,o,u,i,a,l=0;for(n=U(n,e[2],e[3]),i=[],o=n.length,u=!1,r=0;o>r;r++)u?(n[r].length&&(t[m](n[r])?(i.push("("+t[n[r]]+")"),l++):(a=n[r].match(s))?(i.push("("+a[1].split("|").filter(A).map(S).join("|")+")"),l++):n[r].length&&(i.push("("+S(n[r])+")"),l++)),u=!1):(n[r].length&&i.push(S(n[r])),u=!0);return 1===i.length&&1===l?[i.join(""),l]:["("+i.join("")+")",l+1]},M=function(e,t,r,o){var u,i,a,l,s,d,f,h,p,g,m,_,P,R,y;for(u=U(r,e[0],e[1]),l=u.length,f=!1,h="",m=0,_={},a=0;l>a;a++)i=u[a],f?(s=!1,d=!1,p=i.split(e[4]),R=Y(e,t,p[0]),p.length>1&&(P=v(p[1]),s=P.length&&"?"===P.charAt(0),s&&(P=P.slice(1)),(g=P.match(c))?(P=P.slice(0,-g[0].length),y=parseInt(g[1],10),y>=0&&y<R[1]?y+=m+1:y=m+1):y=m+1,d=P.length>0),h+=R[0],m+=R[1],s&&(h+="?"),d&&(_[P]=y),f=!1):(h+=S(i),f=!0);return new n(r,new RegExp("^"+h+"$"),_,o)},$=function(e,t,n,r){var o,u=t.length;for(o=u-1;o>=0;o--)n===t[o].route&&r===t[o].method&&t.splice(o,1);e[n].dispose(),delete e[n]},O=function(e,t,n,r,o,u,i){if(u&&y(u.route)&&u.route.length&&u.handler&&b(u.handler)){i=!0===i;var a,l=u.handler,s=u.defaults||{},c=u.types||null,d=u.method?u.method.toLowerCase():"*";u=o+u.route,e[m](d)||(e[d]={}),a=e[d],a[m](u)?a[u].handlers.push([l,s,c,i,0]):(a[u]=M(n,r,u,d),a[u].handlers.push([l,s,c,i,0]),t.push(a[u]))}},F=function(e,t,n,r,o,u,i){var a,l;for(i=!!i,l=0;l<u.length;l++)a=u[l],O(e,t,n,r,o,a,i)},D=function(e){var t=this;t._delims=["{","}","%","%",":"],t._patterns={},t.definePattern("ALPHA","[a-zA-Z\\-_]+"),t.definePattern("NUMBR","[0-9]+"),t.definePattern("ALNUM","[a-zA-Z0-9\\-_]+"),t.definePattern("QUERY","\\?[^?#]+"),t.definePattern("FRAGM","#[^?#]+"),t.definePattern("PART","[^\\/?#]+"),t.definePattern("ALL",".+"),t._handlers={"*":{}},t._routes=[],t._fallback=!1,t._prefix=e?e:""};return D.VERSION=a,D.Route=n,D.TYPES={INTEGER:r,STRING:o,ARRAY:u,PARAMS:i},D.TYPES.INT=D.TYPES.INTEGER,D.TYPES.STR=D.TYPES.STRING,D.TYPES.URLENCODED=D.TYPES.PARAMS,D.glue_params=function(e){var t="";return e&&(t+=k(e,"&",!0)),t},D.unglue_params=function(e){var t=e?C(e):{};return t},D.parse_components=function(e,t,n){var r=this,o={};return e&&(arguments.length<3&&(n="fragment_params"),arguments.length<2&&(t="query_params"),o=L(e),t&&(o[t]=o.query?r.unglue_params(o.query):{}),n&&(o[n]=o.fragment?r.unglue_params(o.fragment):{})),o},D.build_components=function(e,t,n,r,o){var u=this,i=""+e;return arguments.length<5&&(o="#"),arguments.length<4&&(r="?"),t&&(i+=r+u.glue_params(t)),n&&(i+=o+u.glue_params(n)),i},D.defType=function(e,t){e&&b(t)&&(D.TYPES[e]=t)},D.TYPE=function(e){return e&&D.TYPES[m](e)?D.TYPES[e]:null},D[h]={constructor:D,_delims:null,_patterns:null,_handlers:null,_routes:null,_fallback:!1,_prefix:"",dispose:function(){var e,t,n,r=this;r._delims=null,r._patterns=null,r._routes=null,r._fallback=null,r._prefix=null;for(t in r._handlers)if(r._handlers[m](t)){n=r._handlers[t];for(e in n)n[m](e)&&(n[e].dispose(),n[e]=null)}return r._handlers=null,r},reset:function(){var e=this;return e._handlers={"*":{}},e._routes=[],e._fallback=!1,e},defineDelimiters:function(e){var t,n=this,r=n._delims;return e&&(t=e.length,t>0&&e[0]&&(r[0]=e[0]),t>1&&e[1]&&(r[1]=e[1]),t>2&&e[2]&&(r[2]=e[2]),t>3&&e[3]&&(r[3]=e[3]),t>4&&e[4]&&(r[4]=e[4])),n},definePattern:function(e,t){var n=this;return n._patterns[e]=t,n},dropPattern:function(e){var t=this,n=t._patterns;return n[m](e)&&delete n[e],t},defineType:function(e,t){return D.defType(e,t),this},glue:function(e){return D.glue_params(e)},unglue:function(e){return D.unglue_params(e)},parse:function(e,t,n){return D.parse_components(e,t,n)},build:function(e,t,n,r,o){return D.build_components(e,t,n,r,o)},redirect:function(e,t,n,r){return e&&(_?t&&(arguments.length<3&&(n=302),arguments.length<4&&(r=!0),r?(!0===r&&(r=l[n]||""),t.writeHead(n,r,{Location:e})):t.writeHead(n,{Location:e}),t.end()):document.location.href=e),this},on:function(){var e,t=this,n=arguments,r=n.length;return e=1===r?P(n[0])?n[0]:[n[0]]:2===r&&y(n[0])&&b(n[1])?[{route:n[0],handler:n[1],method:"*",defaults:{},types:null}]:n,F(t._handlers,t._routes,t._delims,t._patterns,t._prefix,e),t},one:function(){var e,t=this,n=arguments,r=n.length;return e=1===r?P(n[0])?n[0]:[n[0]]:2===r&&y(n[0])&&b(n[1])?[{route:n[0],handler:n[1],method:"*",defaults:{},types:null}]:n,F(t._handlers,t._routes,t._delims,t._patterns,t._prefix,e,!0),t},off:function(e,t){var n,r,o,u,i,a=this,l=a._routes,s=a._handlers,c=a._prefix;if(e)if(R(e)){if(o=e.method?e.method.toLowerCase():"*",t=e.handler||t,e=e.route,e&&s[m](o)&&(e=c+e,u=s[o],u[m](e)))if(t&&b(t)){for(r=u[e],i=r.handlers.length,n=i-1;n>=0;n--)t===r.handlers[n][0]&&r.handlers.splice(n,1);r.handlers.length||$(u,l,e,o)}else $(u,l,e,o)}else if(y(e)&&e.length){e=c+e;for(o in s)if(s[m](o)&&(u=s[o],u[m](e)))if(t&&b(t)){for(r=u[e],i=r.handlers.length,n=i-1;n>=0;n--)t===r.handlers[n][0]&&r.handlers.splice(n,1);r.handlers.length||$(u,l,e,o)}else $(u,l,e,o)}return a},fallback:function(e){var t=this;return 1>arguments.length&&(e=!1),(!1===e||null===e||b(e))&&(t._fallback=e),t},route:function(e,t,n){var r,o,u,i,a,l,s,c,d,f,h,p,g,_,P,R,T=this;if(e){for(n=!1!==n,t=t?t.toLowerCase():"*",r=T._routes.slice(),R=!1,s=r.length,l=0;s>l;l++)if(o=r[l],(t===o.method||"*"===o.method)&&(f=e.match(o.pattern))){for(R=!0,_=o.handlers.slice(0),c=_.length,d=0;c>d;d++)if(P=_[d],!P[3]||!P[4]){i=P[1],a=P[2],u={route:e,pattern:o.route,fallback:!1,data:E({},i,!0)};for(h in o.captures)o.captures[m](h)&&(p=o.captures[h],f[p]?a&&a[m](h)&&a[h]?(g=a[h],y(g)&&D.TYPES[m](g)&&(g=D.TYPES[g]),u.data[h]=b(g)?g(f[p]):f[p]):u.data[h]=f[p]:u.data[m](h)||(u.data[h]=null));P[4]=1,P[0](u)}for(d=o.handlers.length-1;d>=0;d--)P=o.handlers[d],P[3]&&P[4]&&o.handlers.splice(d,1);if(o.handlers.length||$(T._handlers[o.method],T._routes,o.route,o.method),n)return!0}if(R)return!0}return T._fallback?(T._fallback({route:e,pattern:null,fallback:!0,data:null}),!1):!1}},D});